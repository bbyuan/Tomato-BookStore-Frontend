<script setup lang="ts">
import { ref } from 'vue'

const categories = ref([
  { id: 1, name: 'ÊñáÂ≠¶', active: false },
  { id: 2, name: 'Á§æÁßë', active: false },
  { id: 3, name: 'Â∞ëÂÑø', active: false },
  { id: 4, name: 'Ëâ∫ÊúØ', active: false },
  { id: 5, name: 'ÁîüÊ¥ª', active: false },
  { id: 6, name: 'ÊñáÊïô', active: false },
])

// Ê†πÊçÆÂõæÁâáÊõ¥Êñ∞Â≠êÂàÜÁ±ª
const subcategories = {
  1: [ // ÊñáÂ≠¶
    { id: 101, name: 'Â∞èËØ¥' },
    { id: 102, name: 'ÈùíÊò•ÊñáÂ≠¶' },
    { id: 103, name: '‰∏≠ÂõΩÊï£Êñá' },
    { id: 104, name: 'Â§ñÂõΩÊï£Êñá' },
    { id: 105, name: 'ÊÇ¨ÁñëÊé®ÁêÜ' },
    { id: 106, name: 'ÊñáÂ≠¶ÁêÜËÆ∫' },
    { id: 107, name: 'ÊñáÈõÜ' },
    { id: 108, name: '‰∏ñÁïåÂêçËëó' },
  ],
  2: [ // Á§æÁßë
    { id: 201, name: 'ÂéÜÂè≤' },
    { id: 202, name: 'Âì≤Â≠¶/ÂÆóÊïô' },
    { id: 203, name: 'Á§æ‰ºöÁßëÂ≠¶' },
    { id: 204, name: 'ÊîøÊ≤ªÂÜõ‰∫ã' },
    { id: 205, name: '‰º†ËÆ∞' },
    { id: 206, name: 'ÊñáÂåñ' },
    { id: 207, name: 'Âè§Á±ç' },
    { id: 208, name: 'ÁÆ°ÁêÜ' },
    { id: 209, name: 'ÁªèÊµé' },
    { id: 210, name: 'ÊàêÂäüÂä±Âøó' },
    { id: 211, name: 'Ê≥ïÂæã' },
    { id: 212, name: 'ËØ≠Ë®ÄÊñáÂ≠ó' },
  ],
  3: [ // Â∞ëÂÑø
    { id: 301, name: '‰∏≠ÂõΩÂÑøÁ´•ÊñáÂ≠¶' },
    { id: 302, name: 'Â§ñÂõΩÂÑøÁ´•ÊñáÂ≠¶' },
    { id: 303, name: 'ÁßëÊôÆËØªÁâ©' },
    { id: 304, name: 'ÁªòÊú¨' },
    { id: 305, name: 'Âä®Êº´/Âç°ÈÄö' },
    { id: 306, name: 'ÂπºÂÑøÂêØËíô' },
  ],
  4: [ // Ëâ∫ÊúØ
    { id: 401, name: 'ÁªòÁîª' },
    { id: 402, name: '‰π¶Ê≥ïÁØÜÂàª' },
    { id: 403, name: 'Ëâ∫ÊúØÁêÜËÆ∫' },
    { id: 404, name: 'ÊëÑÂΩ±' },
    { id: 405, name: 'Èü≥‰πê' },
  ],
  5: [ // ÁîüÊ¥ª
    { id: 501, name: 'ÁæéÈ£ü' },
    { id: 502, name: '‰øùÂÅ•/ÂøÉÁêÜÂÅ•Â∫∑' },
    { id: 503, name: 'ÊóÖÊ∏∏' },
    { id: 504, name: 'ÂÆ∂Â∫≠ÊïôËÇ≤' },
    { id: 505, name: 'ÂÆ∂Â±Ö‰ºëÈó≤' },
  ],
  6: [ // ÊñáÊïô
    { id: 601, name: '‰∏≠Â∞èÂ≠¶ÊïôËæÖ' },
    { id: 602, name: 'Â§ñËØ≠' },
    { id: 603, name: 'ÊïôÊùê' },
    { id: 604, name: 'ÂåªÂ≠¶' },
    { id: 605, name: 'ËÆ°ÁÆóÊú∫' },
    { id: 606, name: 'Ëá™ÁÑ∂ÁßëÂ≠¶' },
  ],
}

// ÂàáÊç¢ÂàÜÁ±ª
const toggleCategory = (id: number) => {
  categories.value.forEach(cat => {
    // Â¶ÇÊûúÁÇπÂáªÁöÑÊòØÂΩìÂâçÊøÄÊ¥ªÁöÑÂàÜÁ±ªÔºåÂàôÂÖ≥Èó≠ÂÆÉ
    if (cat.id === id) {
      cat.active = !cat.active
    } else {
      // ÂÖ∂‰ªñÂàÜÁ±ªËÆæ‰∏∫ÈùûÊøÄÊ¥ª
      cat.active = false
    }
  })
}

// Ëé∑ÂèñÊåáÂÆöÂàÜÁ±ªÁöÑÂ≠êÂàÜÁ±ª
const getSubcategories = (categoryId: number) => {
  return subcategories[categoryId as keyof typeof subcategories] || []
}

const activities = ref([
  { id: 1, name: 'ÂÖ®Âú∫Âõæ‰π¶Êª°100Âáè30ÔºåÈôêÊó∂48Â∞èÊó∂ÔºÅ', type: 'hot' },
  { id: 2, name: 'Êñ∞‰π¶Êä¢ÂÖàÈ¢ÑÂÆöÔºå‰∫´Áã¨ÂÆ∂È¶ñÂèëÁ¶èÂà©', type: 'new' },
  { id: 3, name: 'Áü•Âêç‰ΩúÂÆ∂Á∫ø‰∏ãÁ≠æÂîÆ‰ºöÁÅ´ÁÉ≠Êä•Âêç‰∏≠', type: 'event' },
]);
</script>

<template>
  <div class="aside-container">
    <div class="category-title">
      <div class="title-icon">üìö</div>
      <span class="title-text">Âõæ‰π¶ÂàÜÁ±ª</span>
    </div>
    
    <div class="category-list">
      <div v-for="category in categories" :key="category.id">
        <div class="category-item" 
             :class="{ active: category.active }"
             @click="toggleCategory(category.id)">
          {{ category.name }}
          <i :class="category.active ? 'el-icon-arrow-down' : 'el-icon-arrow-right'"></i>
        </div>
        
        <div class="subcategory-panel" v-if="category.active">
          <div class="subcategory-grid">
            <div v-for="subcat in getSubcategories(category.id)" 
                 :key="subcat.id" 
                 class="subcategory-item">
              {{ subcat.name }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="activity-section">
      <div class="activity-title">
        <div class="title-icon">üî•</div>
        <span class="title-text">ÁÉ≠Èó®Ê¥ªÂä®</span>
      </div>
      
      <div class="activity-list">
        <div v-for="activity in activities" 
             :key="activity.id" 
             class="activity-item">
          <div class="activity-content">
            <p class="activity-text">{{ activity.name }}</p>
            <span class="activity-tag" :class="activity.type">
              {{ activity.type === 'hot' ? 'HOT' : activity.type === 'new' ? 'NEW' : 'EVENT' }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<style scoped>
.aside-container {
  background: #fff;
  border-radius: 8px;
  width: 240px;
  height: fit-content;
  max-height: 100vh;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  border: 1px solid #f0f0f0;
}

.category-title {
  background: linear-gradient(135deg, #ff6b6b 0%, #ff5757 100%);
  color: white;
  padding: 18px 20px;
  font-weight: 700;
  font-size: 16px;
  display: flex;
  align-items: center;
  gap: 10px;
  border-bottom: none;
  box-shadow: 0 2px 12px rgba(255, 107, 107, 0.25);
  position: relative;
  overflow: hidden;
}

.category-title::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 100%;
  height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
  transform: rotate(45deg);
  animation: shimmer 3s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%) rotate(45deg); }
  100% { transform: translateX(100%) rotate(45deg); }
}

.title-icon {
  font-size: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 50%;
  backdrop-filter: blur(10px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.title-text {
  font-weight: 700;
  letter-spacing: 0.5px;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.category-list {
  overflow: hidden;
  padding-right: 2px;
  max-height: 360px;
}

.category-item {
  padding: 10px 18px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.015);
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  font-size: 13px;
  font-weight: 500;
  position: relative;
  color: #666;
  margin-bottom: 1px;
  border-radius: 6px;
}

.category-item::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  width: 3px;
  height: 100%;
  background: linear-gradient(135deg, #ff6b6b, #ff5757);
  transform: scaleY(0);
  transition: transform 0.25s ease;
  transform-origin: center;
  border-radius: 0 2px 2px 0;
}

.category-item::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(255, 107, 107, 0.02), rgba(255, 87, 87, 0.02));
  opacity: 0;
  transition: opacity 0.25s ease;
  border-radius: 6px;
}

.category-item:hover {
  color: #ff6b6b;
  transform: translateX(3px);
}

.category-item:hover::before {
  transform: scaleY(1);
}

.category-item:hover::after {
  opacity: 1;
}

.category-item.active {
  color: #ff6b6b;
  background: linear-gradient(135deg, rgba(255, 107, 107, 0.03), rgba(255, 87, 87, 0.02));
  transform: translateX(3px);
}

.category-item.active::before {
  transform: scaleY(1);
}

.subcategory-panel {
  padding: 10px 12px;
  background: linear-gradient(135deg, #fafafa, #f7f8fc);
  border-bottom: 1px solid rgba(255, 107, 107, 0.06);
  animation: slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  margin: 0 6px 2px 6px;
  border-radius: 6px;
  border: 1px solid rgba(255, 107, 107, 0.06);
  position: relative;
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.02);
}

.subcategory-panel::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, #ff6b6b, #ff5757);
  border-radius: 6px 6px 0 0;
}

@keyframes slideDown {
  from {
    opacity: 0;
    max-height: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    max-height: 150px;
    transform: translateY(0);
  }
}

.subcategory-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.subcategory-item {
  padding: 3px 7px;
  font-size: 10px;
  cursor: pointer;
  background: linear-gradient(135deg, #ffffff, #f8f9fa);
  border-radius: 12px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  margin-bottom: 3px;
  border: 1px solid rgba(255, 107, 107, 0.08);
  font-weight: 500;
  color: #666;
}

.subcategory-item:hover {
  color: #ff6b6b;
  transform: translateY(-2px) scale(1.02);
  box-shadow: 0 4px 12px rgba(255, 107, 107, 0.15);
  background: linear-gradient(135deg, rgba(255, 107, 107, 0.03), #ffffff);
  border-color: rgba(255, 107, 107, 0.2);
}

.activity-section {
  background: #fff;
  border-top: 1px solid #f5f5f5;
  margin-top: 8px;
}

.activity-title {
  padding: 18px 20px;
  font-weight: 700;
  font-size: 16px;
  color: white;
  display: flex;
  align-items: center;
  gap: 10px;
  background: linear-gradient(135deg, #ff6b6b 0%, #ff5757 100%);
  border-bottom: none;
  box-shadow: 0 2px 12px rgba(255, 107, 107, 0.25);
  position: relative;
  overflow: hidden;
}

.activity-title::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 100%;
  height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
  transform: rotate(45deg);
  animation: shimmer 3s infinite;
}

.activity-list {
  padding: 16px 20px;
  max-height: 280px;
  overflow: hidden;
}

.activity-item {
  margin-bottom: 14px;
  padding: 12px 14px;
  background: linear-gradient(135deg, #fafafa, #f7f8fc);
  border-radius: 8px;
  border-left: 4px solid #ff6b6b;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid rgba(255, 107, 107, 0.06);
  position: relative;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
}

.activity-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, #ff6b6b, #ff5757);
  border-radius: 8px 8px 0 0;
}

.activity-item:hover {
  background: linear-gradient(135deg, rgba(255, 107, 107, 0.03), rgba(255, 87, 87, 0.02));
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(255, 107, 107, 0.12);
  border-color: rgba(255, 107, 107, 0.15);
}

.activity-item:last-child {
  margin-bottom: 0;
}

.activity-content {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 8px;
}

.activity-text {
  font-size: 12px;
  line-height: 1.5;
  color: #555;
  margin: 0;
  flex: 1;
  font-weight: 500;
}

.activity-tag {
  font-size: 9px;
  padding: 4px 8px;
  border-radius: 12px;
  font-weight: 700;
  flex-shrink: 0;
  text-transform: uppercase;
  transition: all 0.3s ease;
  letter-spacing: 0.5px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.activity-tag.hot {
  background: linear-gradient(135deg, #ff6b6b, #ff5757);
  color: white;
  box-shadow: 0 2px 6px rgba(255, 107, 107, 0.3);
}

.activity-tag.new {
  background: linear-gradient(135deg, #2ed573, #17c0eb);
  color: white;
  box-shadow: 0 2px 6px rgba(46, 213, 115, 0.3);
}

.activity-tag.event {
  background: linear-gradient(135deg, #ffa502, #ff7675);
  color: white;
  box-shadow: 0 2px 6px rgba(255, 165, 2, 0.3);
}

/* Ëá™ÂÆö‰πâÊªöÂä®Êù° */
.category-list::-webkit-scrollbar {
  width: 3px;
}

.category-list::-webkit-scrollbar-track {
  background: #f8f8f8;
  border-radius: 2px;
}

.category-list::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, #ff6b6b, #ff5757);
  border-radius: 2px;
}

.category-list::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(135deg, #ff5757, #ff4757);
}

@media (max-width: 768px) {
  .aside-container {
    width: 100%;
    margin-bottom: 20px;
  }
  
  .category-title {
    padding: 16px 18px;
    font-size: 15px;
  }
  
  .title-icon {
    width: 24px;
    height: 24px;
    font-size: 18px;
  }
  
  .category-item {
    padding: 9px 16px;
    font-size: 12px;
  }
  
  .subcategory-panel {
    padding: 8px 10px;
    margin: 0 4px 2px 4px;
  }
  
  .activity-title {
    padding: 16px 18px;
    font-size: 15px;
  }
  
  .activity-list {
    padding: 14px 18px;
  }
  
  .activity-item {
    padding: 10px 12px;
  }
  
  .activity-text {
    font-size: 11px;
  }
}
</style>
